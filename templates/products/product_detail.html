{% extends 'base.html' %}
{% block content %}
  <div class="card" style="margin-bottom:12px">
    <a href="/">Home</a> / <a href="/?category={{ product.category.slug }}">{{ product.category.name }}</a> / {{ product.name }}
  </div>
  <div class="layout" style="grid-template-columns: 1fr 1fr;">
    <div class="card">
      {% if product.image %}
        <img src="{{ product.image.url }}" alt="{{ product.name }}">
      {% endif %}
    </div>
    <div class="card">
      <h2 style="font-size:32px">{{ product.name }}</h2>
      {% load humanize %}
      <div class="price">${{ product.price|floatformat:2 }}</div>
      <div>Stock: {{ product.stock }}</div>
      <p style="font-size:18px;line-height:1.6">{{ product.description }}</p>
      <div style="display:flex; gap:10px; flex-wrap:wrap">
        <a class="btn btn-primary" href="/cart/add/{{ product.id }}/">Add to Cart</a>
        <a class="btn" href="/wishlist/toggle/{{ product.id }}/">Toggle Wishlist</a>
      </div>
    </div>
  </div>

  <div class="card" style="margin-top:16px">
    <h3>Reviews{% if avg_rating %} · Avg {{ avg_rating|floatformat:1 }}/5{% endif %}</h3>
    <div>
      {% for r in product.reviews.all %}
        <div style="margin:10px 0; border-top:1px solid #e5e7eb; padding-top:10px">
          <strong>{{ r.user_name|default:"Anonymous" }}</strong> — {{ r.rating }}/5
          <div>{{ r.comment }}</div>
          <div style="color:#64748b; font-size:12px">{{ r.created_at|date:'Y-m-d H:i' }}</div>
        </div>
      {% empty %}
        <p>No reviews yet.</p>
      {% endfor %}
    </div>
    <form method="post" style="margin-top:12px">
      {% csrf_token %}
      <input type="hidden" name="action" value="review">
      {{ review_form.as_p }}
      <button class="btn">Submit Review</button>
    </form>
  </div>
{% endblock %}


